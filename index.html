<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Carta M√°gica ‚ú®</title>
  <style>
    /* reset css */
    * {
      min-width: 0;
      font: inherit;
      margin: 0;
      padding: 0;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      overflow: hidden;
      position: relative;
    }

    /* Estrellas y fondo animado */
    .stars, .twinkling {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      display: block;
      pointer-events: none;
    }

    .stars {
      background: #000 url('https://i.imgur.com/YKY28eT.png') repeat top center;
      z-index: -3;
    }

    .twinkling {
      background: transparent url('https://i.imgur.com/XYMF4ca.png') repeat top center;
      z-index: -2;
      animation: move-twink-back 200s linear infinite;
    }

    @keyframes move-twink-back {
      from {background-position: 0 0;}
      to {background-position: -10000px 5000px;}
    }

    body {
      background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    main {
      display: flex;
      flex-direction: column;
      gap: 3rem;
      justify-content: center;
      align-items: center;
      height: 100vh;
      position: relative;
      z-index: 10;
      padding: 1rem;
    }

    .title {
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      color: white;
      text-shadow: 0 0 10px rgba(255,255,255,0.5);
      animation: titleGlow 2s ease-in-out infinite;
      font-family: 'Arial', cursive;
      letter-spacing: 3px;
      z-index: 20;
      text-align: center;
      padding: 0 1rem;
    }

    @keyframes titleGlow {
      0%, 100% { text-shadow: 0 0 20px #fff, 0 0 30px #ff4da6; }
      50% { text-shadow: 0 0 30px #fff, 0 0 50px #ff4da6, 0 0 70px #ff4da6; }
    }

    .container-letter {
      position: relative;
      width: min(400px, 90vw);
      height: min(300px, 65vw);
      cursor: pointer;
      transition: transform 0.3s;
      z-index: 30;
      max-width: 400px;
      max-height: 300px;
    }

    .container-letter:hover {
      transform: scale(1.05);
    }

    .cover {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #ff6b6b, #ff4757);
      border-radius: 15px 15px 0 0;
      transition: transform 0.8s;
      transform-origin: top;
      z-index: 10;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .cover-decoration {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: clamp(2rem, 8vw, 3rem);
      animation: heartbeat 1.5s ease-in-out infinite;
    }

    @keyframes heartbeat {
      0% { transform: translate(-50%, -50%) scale(1); }
      14% { transform: translate(-50%, -50%) scale(1.3); }
      28% { transform: translate(-50%, -50%) scale(1); }
      42% { transform: translate(-50%, -50%) scale(1.3); }
      70% { transform: translate(-50%, -50%) scale(1); }
    }

    .letter-body {
      position: absolute;
      width: 100%;
      height: 100%;
      background: #fff5f5;
      border-radius: 10px;
      padding: clamp(10px, 3vw, 20px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      overflow: hidden;
    }

    .letter-border {
      position: absolute;
      top: 5px;
      left: 5px;
      right: 5px;
      bottom: 5px;
      border: 2px dashed #ff6b6b;
      border-radius: 10px;
      pointer-events: none;
      z-index: 5;
    }

    .paper {
      position: absolute;
      top: clamp(10px, 3vw, 20px);
      left: clamp(10px, 3vw, 20px);
      right: clamp(10px, 3vw, 20px);
      z-index: 2;
      font-size: clamp(0.8rem, 2.5vw, 1.1rem);
      line-height: 1.4;
      color: #333;
      text-align: center;
      font-family: 'Arial', cursive;
      background: white;
      padding: clamp(8px, 2vw, 15px);
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      transition: all 0.5s;
      max-height: 80%;
      overflow-y: auto;
    }

    /* Scroll personalizado para el texto */
    .paper::-webkit-scrollbar {
      width: 5px;
    }

    .paper::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .paper::-webkit-scrollbar-thumb {
      background: #ff6b6b;
      border-radius: 10px;
    }

    .main-heart {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0;
      opacity: 0;
      transition: all 0.5s;
      z-index: 10;
    }

    /* Mariposas (fondo) */
    .butterfly-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5;
    }

    .butterfly {
      position: absolute;
      font-size: clamp(1.2rem, 4vw, 2rem);
      opacity: 0.6;
      filter: drop-shadow(0 0 5px rgba(255,255,255,0.5));
    }

    /* Posiciones responsivas para mariposas */
    .butterfly1 { top: 5%; left: 5%; }
    .butterfly2 { top: 70%; right: 5%; }
    .butterfly3 { bottom: 10%; left: 10%; }
    .butterfly4 { top: 30%; right: 10%; }
    .butterfly5 { bottom: 20%; left: 20%; }
    .butterfly6 { top: 50%; left: 30%; }
    .butterfly7 { bottom: 5%; right: 15%; }
    .butterfly8 { top: 15%; right: 25%; }

    /* Animaciones mariposas */
    .butterfly1 { animation: fly1 20s linear infinite; }
    .butterfly2 { animation: fly2 18s linear infinite; animation-delay: -5s; }
    .butterfly3 { animation: fly3 22s linear infinite; animation-delay: -2s; }
    .butterfly4 { animation: fly4 16s linear infinite; animation-delay: -8s; }
    .butterfly5 { animation: fly5 25s linear infinite; animation-delay: -12s; }
    .butterfly6 { animation: fly1 19s linear infinite; animation-delay: -3s; }
    .butterfly7 { animation: fly2 21s linear infinite; animation-delay: -7s; }
    .butterfly8 { animation: fly3 17s linear infinite; animation-delay: -9s; }

    @keyframes fly1 {
      0% { transform: translate(0, 0) rotate(0deg); }
      25% { transform: translate(50px, -30px) rotate(10deg); }
      50% { transform: translate(100px, 0) rotate(0deg); }
      75% { transform: translate(50px, 30px) rotate(-10deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    @keyframes fly2 {
      0% { transform: translate(0, 0) rotate(0deg); }
      33% { transform: translate(-80px, 40px) rotate(-15deg); }
      66% { transform: translate(-150px, -20px) rotate(5deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    @keyframes fly3 {
      0% { transform: translate(0, 0) rotate(0deg); }
      20% { transform: translate(60px, -40px) rotate(20deg); }
      40% { transform: translate(100px, 20px) rotate(-5deg); }
      60% { transform: translate(40px, 60px) rotate(15deg); }
      80% { transform: translate(-30px, 30px) rotate(-10deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    @keyframes fly4 {
      0% { transform: translate(0, 0) rotate(0deg); }
      25% { transform: translate(-40px, -50px) rotate(-20deg); }
      50% { transform: translate(-100px, -20px) rotate(5deg); }
      75% { transform: translate(-50px, 40px) rotate(15deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    @keyframes fly5 {
      0% { transform: translate(0, 0) rotate(0deg); }
      20% { transform: translate(80px, 30px) rotate(25deg); }
      40% { transform: translate(40px, 80px) rotate(-15deg); }
      60% { transform: translate(-30px, 120px) rotate(10deg); }
      80% { transform: translate(-70px, 40px) rotate(-20deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    /* Sparkles (fondo) */
    .sparkles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 6;
    }

    .sparkle {
      position: absolute;
      font-size: clamp(1rem, 3vw, 1.5rem);
      opacity: 0;
      animation: sparkleFloat 4s ease-in-out infinite;
    }

    .sparkle:nth-child(1) { top: 10%; left: 10%; }
    .sparkle:nth-child(2) { top: 20%; right: 15%; }
    .sparkle:nth-child(3) { bottom: 25%; left: 20%; }
    .sparkle:nth-child(4) { bottom: 15%; right: 15%; }
    .sparkle:nth-child(5) { top: 40%; left: 40%; }
    .sparkle:nth-child(6) { top: 70%; left: 10%; }
    .sparkle:nth-child(7) { bottom: 30%; right: 25%; }
    .sparkle:nth-child(8) { top: 80%; right: 30%; }

    @keyframes sparkleFloat {
      0% { transform: scale(0) rotate(0deg); opacity: 0; }
      20% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
      40% { transform: scale(0.8) rotate(360deg); opacity: 0.4; }
      60% { transform: scale(1) rotate(540deg); opacity: 0.6; }
      80% { transform: scale(0.5) rotate(720deg); opacity: 0.2; }
      100% { transform: scale(0) rotate(900deg); opacity: 0; }
    }

    /* Glitter en la carta */
    .glitter {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8) 0%, transparent 50%);
      animation: glitter 2s linear infinite;
      opacity: 0.3;
      pointer-events: none;
    }

    @keyframes glitter {
      0% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }
      25% { transform: translate(5px, 5px) rotate(5deg); opacity: 0.5; }
      50% { transform: translate(0, 10px) rotate(0deg); opacity: 0.3; }
      75% { transform: translate(-5px, 5px) rotate(-5deg); opacity: 0.5; }
      100% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }
    }

    .options {
      display: flex;
      gap: clamp(1rem, 3vw, 2rem);
      z-index: 30;
      flex-wrap: wrap;
      justify-content: center;
      padding: 0 1rem;
    }

    .btn-open, .btn-close {
      padding: clamp(0.8rem, 2vw, 1rem) clamp(1.5rem, 4vw, 2rem);
      font-size: clamp(1rem, 3vw, 1.2rem);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      z-index: 30;
      white-space: nowrap;
    }

    .btn-open {
      background: linear-gradient(135deg, #ff6b6b, #ff4757);
      color: white;
    }

    .btn-close {
      background: linear-gradient(135deg, #7f8c8d, #34495e);
      color: white;
    }

    .btn-open:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5);
    }

    .btn-close:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(52, 73, 94, 0.5);
    }

    .btn-open:disabled, .btn-close:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .floating-hearts {
      position: fixed;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 4;
    }

    .floating-heart {
      position: absolute;
      font-size: clamp(1.2rem, 4vw, 2rem);
      animation: float 8s linear infinite;
      opacity: 0;
    }

    .floating-heart:nth-child(1) { left: 5%; animation-delay: 0s; }
    .floating-heart:nth-child(2) { left: 20%; animation-delay: 1.2s; }
    .floating-heart:nth-child(3) { left: 35%; animation-delay: 2.4s; }
    .floating-heart:nth-child(4) { left: 50%; animation-delay: 3.6s; }
    .floating-heart:nth-child(5) { left: 65%; animation-delay: 4.8s; }
    .floating-heart:nth-child(6) { left: 80%; animation-delay: 5.5s; }
    .floating-heart:nth-child(7) { left: 95%; animation-delay: 6.3s; }

    @keyframes float {
      0% { transform: translateY(100vh) scale(1); opacity: 0; }
      10% { opacity: 0.8; }
      90% { opacity: 0.8; }
      100% { transform: translateY(-100vh) scale(1.5); opacity: 0; }
    }

    /* Clases para animaciones de apertura/cierre */
    .open-cover {
      transform: rotateX(180deg);
    }

    .paper.open-paper {
      z-index: 20;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .paper.close-paper {
      z-index: 2;
    }

    .heart-visible {
      font-size: clamp(2rem, 8vw, 3rem) !important;
      opacity: 1 !important;
      animation: heartPop 0.5s forwards !important;
    }

    @keyframes heartPop {
      0% { transform: translate(-50%, -50%) scale(0); }
      50% { transform: translate(-50%, -50%) scale(1.5); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }

    /* Media queries espec√≠ficas para m√≥viles */
    @media (max-width: 480px) {
      main {
        gap: 2rem;
      }
      
      .options {
        gap: 1rem;
      }
      
      .btn-open, .btn-close {
        padding: 0.8rem 1.2rem;
        font-size: 1rem;
      }
      
      .paper {
        line-height: 1.3;
      }
    }

    /* Para pantallas muy peque√±as */
    @media (max-width: 320px) {
      .options {
        flex-direction: column;
        align-items: center;
      }
      
      .btn-open, .btn-close {
        width: 200px;
        white-space: normal;
      }
    }

    /* Para tablets */
    @media (min-width: 768px) and (max-width: 1024px) {
      .container-letter {
        width: 380px;
        height: 285px;
      }
    }

    /* Para pantallas grandes */
    @media (min-width: 1200px) {
      .container-letter {
        width: 450px;
        height: 340px;
      }
    }
  </style>
</head>
<body>
  <!-- Fondos decorativos -->
  <div class="stars"></div>
  <div class="twinkling"></div>
  
  <!-- Mariposas de fondo -->
  <div class="butterfly-container">
    <div class="butterfly butterfly1">ü¶ã</div>
    <div class="butterfly butterfly2">ü¶ã</div>
    <div class="butterfly butterfly3">ü¶ã</div>
    <div class="butterfly butterfly4">ü¶ã</div>
    <div class="butterfly butterfly5">ü¶ã</div>
    <div class="butterfly butterfly6">ü¶ã</div>
    <div class="butterfly butterfly7">ü¶ã</div>
    <div class="butterfly butterfly8">ü¶ã</div>
  </div>
  
  <!-- Brillos de fondo -->
  <div class="sparkles">
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
    <div class="sparkle">‚ú®</div>
  </div>
  
  <!-- Corazones flotantes -->
  <div class="floating-hearts">
    <div class="floating-heart">‚ù§Ô∏è</div>
    <div class="floating-heart">üíñ</div>
    <div class="floating-heart">üíó</div>
    <div class="floating-heart">üíì</div>
    <div class="floating-heart">üíï</div>
    <div class="floating-heart">üíò</div>
    <div class="floating-heart">üíù</div>
  </div>

  <main>
    <h1 class="title">üíå Carta Especial üíå</h1>
    
    <div class="container-letter">
      <div class="cover">
        <div class="cover-decoration">‚ù§Ô∏è</div>
      </div>
      
      <div class="letter-body">
        <span class="heart main-heart">‚ù§Ô∏è</span>
        <div class="glitter"></div>
        <div class="letter-border"></div>
        <p class="paper" id="mainMessage">
          En este d√≠a quiero agradecerte por estar a mi lado. Gracias por tanto y perd√≥n por tan poco. 
          Te aprecio mucho Naye, ¬°Feliz dia! ‚ú®
        </p>
      </div>
    </div>
    
    <div class="options">
      <button id="open" class="btn-open">
        <span>‚ú®</span> Abrir <span>‚ú®</span>
      </button>
      <button id="close" class="btn-close">
        <span>üì¶</span> Cerrar <span>üì¶</span>
      </button>
    </div>
  </main>

  <script>
    // Leer mensaje personalizado de query strings
    const urlSearchParams = new URLSearchParams(window.location.search);
    const messageCustom = urlSearchParams.get('message');

    if (messageCustom) {
      const mainMessageElement = document.querySelector('#mainMessage');
      mainMessageElement.textContent = decodeURI(messageCustom);
    }

    // Elementos del DOM
    const btnOpenElement = document.querySelector('#open');
    const btnCloseElement = document.querySelector('#close');
    const coverElement = document.querySelector('.cover');
    const paperElement = document.querySelector('.paper');
    const heartElement = document.querySelector('.heart');

    // Estado inicial
    btnCloseElement.disabled = true;

    // Evento abrir
    btnOpenElement.addEventListener('click', () => {
      btnOpenElement.disabled = true;
      btnCloseElement.disabled = false;
      
      coverElement.classList.add('open-cover');

      setTimeout(() => {
        coverElement.style.zIndex = -1;
        paperElement.classList.remove('close-paper');
        paperElement.classList.add('open-paper');
        
        // Animar coraz√≥n
        heartElement.classList.add('heart-visible');
        
        // Crear confeti
        createConfetti();
        
      }, 500);
    });

    // Evento cerrar
    btnCloseElement.addEventListener('click', () => {
      btnOpenElement.disabled = false;
      btnCloseElement.disabled = true;

      paperElement.classList.remove('open-paper');
      paperElement.classList.add('close-paper');
      
      setTimeout(() => {
        coverElement.style.zIndex = 10;
        coverElement.classList.remove('open-cover');
        
        // Ocultar coraz√≥n
        heartElement.classList.remove('heart-visible');
        
      }, 500);
    });

    // Funci√≥n para crear confeti
    function createConfetti() {
      for (let i = 0; i < 30; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.style.position = 'fixed';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.top = -10 + 'px';
          confetti.style.width = Math.random() * 10 + 5 + 'px';
          confetti.style.height = confetti.style.width;
          confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
          confetti.style.borderRadius = '50%';
          confetti.style.pointerEvents = 'none';
          confetti.style.zIndex = '1000';
          confetti.style.animation = `fall ${Math.random() * 2 + 2}s linear forwards`;
          
          document.body.appendChild(confetti);
          
          setTimeout(() => {
            confetti.remove();
          }, 4000);
        }, i * 50);
      }
    }

    // A√±adir estilo para la animaci√≥n de confeti
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fall {
        to {
          transform: translateY(100vh) rotate(360deg);
        }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>